version: '3.8'

services:
  file-proxy:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: file-proxy-server
    restart: unless-stopped
    command: /app/app --config /app/config/config.yaml

    # 端口映射配置
    # 格式: "宿主机端口:容器内端口"
    # 例如修改宿主机端口为8080: "8080:3000"
    ports:
      - "10048:3000"

    # 卷挂载配置
    # 将宿主机的数据目录挂载到容器内的 /app/data
    # 修改路径: "/your/local/path:/app/data"
    volumes:
      - "../wss-collector/data:/app/data"
      # 挂载配置文件目录
      - "./config:/app/config:ro"
      # 挂载数据库目录
      - "./db:/app/db"

    environment:
      # 应用监听的端口（容器内部）
      # 必须与 ports 中冒号后面的端口一致
      PORT: "3000"
      
      # 日志级别: trace, debug, info, warn, error
      RUST_LOG: "info"
      
      # 文件代理的基础目录（容器内路径）
      FILE_PROXY_DIR: "/app/data"
